(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[59],{AXl7:function(e,t,a){"use strict";var l=a("4Gf+"),n=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DxMX");var r=l(a("ivY1"));a("qhfc");var i=l(a("aEti"));a("fr3b");var o=l(a("Bziu"));a("P7WH");var d=l(a("KVOY"));a("sXvm");var s=l(a("0WXq"));a("Olrz");var u=l(a("u4tl"));a("slQz");var f=l(a("EXKx"));a("CKBq");var c,p,m=l(a("nvQ8")),h=l(a("jx1L")),v=l(a("pvd2")),y=l(a("RPUv")),E=l(a("1KPh")),g=l(a("ZA+g")),k=n(a("ZS5U")),I=a("rAnT"),b=l(a("hXee")),w=l(a("A6oz")),C=a("+n12"),P=(c=(0,I.connect)(function(e){var t=e.role,a=e.loading;return{role:t,loading:a.models.role}}),c(p=function(e){function t(){var e,a;(0,h.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,y.default)(this,(e=(0,E.default)(t)).call.apply(e,[this].concat(n))),a.state={tableData:[],relationIds:[],roleId:""},a.onChange=function(e){var t=a.state.relationIds;if(e.target.checked)t.push(e.target.value);else{var l=t.indexOf(e.target.value);l>-1&&t.splice(l,1)}a.setState({relationIds:t},function(){console.info("relationIds ===",a.state.relationIds)})},a}return(0,g.default)(t,e),(0,v.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch,t=this.props.match.params;this.setState({roleId:t.id}),e({type:"role/getRoleRelationPermission",payload:{id:t.id}})}},{key:"componentWillReceiveProps",value:function(e){if(e.role!=this.props.role){for(var t=e.role.permission,a=e.role.rolePermission,l=[],n=0;n<a.length;n++)l.push(a[n].id);if(!(0,C.isEmpty)(t))for(var r=0;r<t.length;r++)for(var i=0;i<a.length;i++)t[r].id==a[i].id&&(t[r].checked=!0);var o=[];if(!(0,C.isEmpty)(t))for(var c=0;c<t.length;c++)if("0"==t[c].parentCode){for(var p=[],h=0;h<t.length;h++)t[c].id==t[h].parentCode&&p.push(k.default.createElement(s.default,{key:t[h].id,span:2},k.default.createElement(u.default,{value:t[h].id,defaultChecked:t[h].checked,onChange:this.onChange},t[h].name," \xa0",t[h].description?k.default.createElement(f.default,{title:t[h].description},k.default.createElement(m.default,{type:"question-circle-o",style:{color:"#8b96ff"}})):k.default.createElement("span",null))));o.push(k.default.createElement("tr",{key:t[c].id},k.default.createElement("th",{style:{paddingLeft:"20px",width:"100px"}},t[c].name," \xa0",t[c].description?k.default.createElement(f.default,{title:t[c].description},k.default.createElement(m.default,{type:"question-circle-o",style:{color:"#8b96ff"}})):k.default.createElement("span",null)),k.default.createElement("td",null,k.default.createElement(d.default,{style:{margin:"10px"}},p))))}this.setState({tableData:o,relationIds:l})}}},{key:"render",value:function(){var e=this.props,t=e.role,a=t.data,l=(t.currentItem,t.permission,t.rolePermission,e.dispatch),n=(e.loading,this.state),d=n.tableData,s=n.relationIds,u=n.roleId;function f(){var e="";if(!(0,C.isEmpty)(s)){e=s[0];for(var t=1;t<s.length;t++)e+=","+s[t]}console.info("permissions ===",e),l({type:"role/setRoleRelationPermission",payload:{permissions:e,roleId:u,pagination:a.pagination}})}function c(){b.default.push("/system/role")}return k.default.createElement(r.default,{bordered:!1,className:w.default.card},k.default.createElement("div",null,k.default.createElement(o.default,{message:k.default.createElement("div",null,"\u89d2\u8272\u6743\u9650\u660e\u7ec6"),type:"info",showIcon:!0})),k.default.createElement("table",{style:{width:"100%"}},k.default.createElement("tbody",null,d)),k.default.createElement("div",{className:w.default.actions},k.default.createElement(i.default,{onClick:f,type:"primary"},"\u4fdd\u5b58"),k.default.createElement(i.default,{onClick:c},"\u8fd4\u56de")))}}]),t}(k.PureComponent))||p);t.default=P}}]);